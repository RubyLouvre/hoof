{"version":3,"file":"main.js","sources":["../..//Users/wenyuxiang/Seafile/hoof/src/property/dependency_detection.ts","../..//Users/wenyuxiang/Seafile/hoof/src/property/dirty_propagation.ts","../..//Users/wenyuxiang/Seafile/hoof/src/utils/callable.ts","../..//Users/wenyuxiang/Seafile/hoof/src/property/property.ts","../..//Users/wenyuxiang/Seafile/hoof/src/property/stored.ts","../..//Users/wenyuxiang/Seafile/hoof/src/property/constant.ts","../..//Users/wenyuxiang/Seafile/hoof/src/property/computed.ts","../..//Users/wenyuxiang/Seafile/hoof/src/view/script.ts","../..//Users/wenyuxiang/Seafile/hoof/src/view/render/text.ts","../..//Users/wenyuxiang/Seafile/hoof/src/view/render/element.ts","../..//Users/wenyuxiang/Seafile/hoof/src/view/render/fragment.ts","../..//Users/wenyuxiang/Seafile/hoof/src/view/render/property.ts","../..//Users/wenyuxiang/Seafile/hoof/src/utils/compare_arrays.ts","../..//Users/wenyuxiang/Seafile/hoof/src/utils/insert_after.ts","../..//Users/wenyuxiang/Seafile/hoof/src/utils/iterate_from_til.ts","../..//Users/wenyuxiang/Seafile/hoof/src/view/render/dynamic_list.ts","../..//Users/wenyuxiang/Seafile/hoof/src/view/render.ts","main.tsx"],"sourcesContent":["import {Property} from './property';\n\nlet stack: Property<any>[][] = [];\nlet frame: Property<any>[] = null;\n\nexport function track(property: Property<any>) {\n\tif (frame !== null) {\n        if (frame.indexOf(property) < 0) {\n\t\t  frame.push(property);\n        }\n\t}\n}\n\nexport function evaluate<TValue>(getter: () => TValue) {\n\tstack.push(frame);\n\tframe = [];\n\tlet value = getter();\n\tlet dependencies = frame;\n\tframe = stack.pop();\n\treturn {value, dependencies};\n}\n","import {Property} from './property';\n\ninterface Updatable {\n\tupdate(): void;\n}\n\nlet dirtySeeds: Set<Property<any>> = new Set();\nlet updateQueue: Set<Updatable> = new Set();\nlet scheduled = false;\nlet committing = false;\nlet fulfilled = Promise.resolve();\n\nfunction schedule() {\n\tif (!scheduled) {\n\t\tscheduled = true;\n\t\tfulfilled.then(flush);\n\t}\n}\n\nfunction flush() {\n\tcommit();\n\tscheduled = false;\n}\n\nexport function mark(property: Property<any>) {\n\tdirtySeeds.add(property);\n\tschedule();\n}\n\nexport function queue(target: Updatable) {\n    updateQueue.add(target);\n    schedule();\n}\n\nfunction notify(target: Property<any>) {\n\ttarget.notifyObservers();\n}\n\nfunction update(target: Updatable) {\n\ttarget.update();\n}\n\nexport function commit() {\n\tif (committing) {\n\t\treturn;\n\t}\n\tcommitting = true;\n    while (dirtySeeds.size > 0 || updateQueue.size > 0) {\n        while (dirtySeeds.size > 0) {\n            let properties = dirtySeeds;\n            dirtySeeds = new Set();\n            properties.forEach(notify);\n        }\n        while (updateQueue.size > 0) {\n            let properties = updateQueue;\n            updateQueue = new Set();\n            properties.forEach(update);\n        }\n    }\n\tcommitting = false;\n}","export abstract class Callable {\n\tpublic constructor() {\n\t\tfunction delegate(...args) {\n\t\t\treturn (delegate as any as Callable).invoke(...args);\n\t\t}\n\t\tObject.setPrototypeOf(delegate, Object.getPrototypeOf(this));\n\t\treturn (delegate as any as Callable);\n\t}\n\tprotected abstract invoke(...args);\n}\n","import * as dependencyDetection from './dependency_detection';\nimport * as dirtyPropagation from './dirty_propagation';\nimport {Callable} from '../utils/callable';\n\nexport interface Property<TValue> {\n\t(): TValue;\n}\n\ninterface Observer<TValue> {\n\tonNotify(property: Property<TValue>): void;\n}\n\nexport abstract class Property<TValue> extends Callable {\n\tpublic version: number = 0;\n\tprotected field: TValue;\n\tprotected observers: Observer<TValue>[];\n\n\tpublic constructor() {\n\t\tsuper();\n\t\tif (!this.isFinal()) {\n\t\t\tthis.observers = [];\n\t\t}\n\t}\n\n\tpublic isFinal() {\n\t\treturn false;\n\t}\n\n\tprotected setField(value: TValue) {\n        // TODO:\n\t\tif (!Object.is(value, this.field) || (typeof value === 'object' || typeof value === 'function')) {\n\t\t\tthis.field = value;\n\t\t\tthis.version++;\n\t\t\tdirtyPropagation.mark(this);\n\t\t}\n\t}\n\n\tprotected invoke() {\n\t\treturn this.value();\n\t}\n\n\tpublic value() {\n\t\tdependencyDetection.track(this);\n\t\treturn this.get();\n\t}\n\tprotected abstract get(): TValue;\n\tpublic abstract set(value: TValue);\n\n\tprotected activate() { }\n\tprotected deactivate() { }\n\n\tpublic addObserver(observer: Observer<TValue>) {\n\t\tif (this.isFinal()) {\n\t\t\treturn;\n\t\t}\n\t\tif (this.observers.length <= 0) {\n\t\t\tthis.activate();\n\t\t}\n\t\tthis.observers.push(observer);\n\t}\n\n\tpublic removeObserver(observer: Observer<TValue>) {\n\t\tif (this.isFinal()) {\n\t\t\treturn;\n\t\t}\n\t\tlet index = this.observers.indexOf(observer);\n\t\tif (index >= 0) {\n\t\t\tthis.observers.splice(index, 1);\n\t\t\tif (this.observers.length <= 0) {\n\t\t\t\tthis.deactivate();\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic notifyObservers() {\n\t\tfor (let i = 0; i < this.observers.length; i++) {\n\t\t\tlet observer = this.observers[i];\n\t\t\tobserver.onNotify(this);\n\t\t}\n\t\tif (this.isFinal()) {\n\t\t\tthis.observers = undefined;\n\t\t}\n\t}\n}\n","import {Property} from './property';\n\nexport class StoredProperty<TValue> extends Property<TValue> {\n\tprivate filter(value: TValue) {\n\t\treturn value;\n\t}\n\n\tpublic constructor(initialValue: TValue, filter?: (value: TValue) => TValue) {\n\t\tsuper();\n\t\tif (filter !== undefined) {\n\t\t\tthis.filter = filter;\n\t\t}\n\t\tthis.field = (this.filter)(initialValue);\n\t}\n\n\tprotected get() {\n\t\treturn this.field;\n\t}\n\n\tpublic set(value: TValue) {\n\t\tthis.setField(value);\n\t}\n}\n\nexport function stored<TValue>(initialValue: TValue, filter?: (value: TValue) => TValue) {\n\treturn new StoredProperty(initialValue, filter);\n}\n","import {Property} from './property';\n\nexport class ConstantProperty<TValue> extends Property<TValue> {\n\tpublic constructor(value: TValue) {\n\t\tsuper();\n\t\tthis.field = value;\n\t}\n\n\tpublic isFinal() {\n\t\treturn true;\n\t}\n\n\tprotected get() {\n\t\treturn this.field;\n\t}\n\n\tpublic set(value: TValue) {\n\t\tthrow new Error('Write to constant property');\n\t}\n}\n\nexport function constant<TValue>(value: TValue) {\n\treturn new ConstantProperty(value);\n}","import {Property} from './property';\nimport * as dependencyDetection from './dependency_detection';\nimport * as dirtyPropagation from './dirty_propagation';\n\nconst enum Flags {\n\tnone = 0,\n\tactive = 1,\n\tinitial = 2,\n\tevaluating = 4,\n\tupdated = 8,\n\tfinal = 16\n}\n\nexport class ComputedProperty<TValue> extends Property<TValue> {\n\tprivate flags: Flags = Flags.initial;\n\tprivate dependencies: Property<any>[];\n\tprivate getter: () => TValue;\n\tprivate setter(value: TValue) {\n\t\tthrow new Error('Write to non-writable computed property');\n\t}\n\n\tpublic constructor(getter: () => TValue, setter?: (value: TValue) => void) {\n\t\tsuper();\n\t\tthis.getter = getter;\n\t\tif (setter !== undefined) {\n\t\t\tthis.setter = setter;\n\t\t}\n\t}\n\n\tpublic isFinal() {\n\t\treturn (this.flags & Flags.final) !== 0;\n\t}\n\n\tprotected activate() {\n\t\tthis.flags |= Flags.active;\n\t\tdirtyPropagation.queue(this);\n\t\tdirtyPropagation.commit();\n\t}\n\n\tprotected deactivate() {\n\t\tthis.flags &= ~Flags.active;\n\t\tif (this.dependencies !== undefined) {\n\t\t\tthis.dependencies.forEach((dependency) => {\n\t\t\t\tdependency.removeObserver(this);\n\t\t\t});\n\t\t\tthis.dependencies = undefined;\n\t\t}\n\t}\n\n\tprivate setDependencies(newDependencies: Property<any>[]) {\n\t\tif ((this.flags & Flags.active) === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet oldDependencies = this.dependencies;\n\t\tif (oldDependencies !== undefined) {\n            for (let j = oldDependencies.length; j-- > 0;) {\n                let dependency = oldDependencies[j];\n                if (newDependencies === undefined || newDependencies.indexOf(dependency) < 0) {\n                    dependency.removeObserver(this);\n                }\n            }\n\t\t}\n\t\tif (newDependencies !== undefined) {\n            for (let j = newDependencies.length; j-- > 0;) {\n                let dependency = newDependencies[j];\n                if (oldDependencies === undefined || oldDependencies.indexOf(dependency) < 0) {\n                    dependency.addObserver(this);\n                }\n            }\n\t\t}\n\t\tthis.dependencies = newDependencies;\n\t}\n\n\tprotected get() {\n\t\tif ((this.flags & Flags.evaluating) !== 0) {\n\t\t\tthrow new Error('Circular dependency detected');\n\t\t}\n\t\tdirtyPropagation.commit();\n\t\tthis.update();\n\t\treturn this.field;\n\t}\n\n\tpublic update() {\n\t\tif ((this.flags & Flags.updated) !== 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.flags |= Flags.evaluating;\n\t\tlet {value, dependencies} = dependencyDetection.evaluate(this.getter);\n\t\tthis.flags &= ~Flags.evaluating;\n\n\t\tif (dependencies.length <= 0) {\n\t\t\tdependencies = undefined;\n\t\t\tthis.flags |= Flags.final;\n\t\t}\n\n\t\tif ((this.flags & Flags.initial) !== 0) {\n\t\t\tthis.field = value;\n\t\t\tthis.flags &= ~Flags.initial;\n\t\t\tif (this.isFinal()) {\n\t\t\t\tthis.observers = undefined;\n\t\t\t}\n\t\t} else {\n\t\t\tthis.setField(value);\n\t\t}\n\n\t\tthis.setDependencies(dependencies);\n\t\tthis.flags |= Flags.updated;\n\t}\n\n\tpublic set(value: TValue) {\n\t\t(this.setter)(value);\n\t}\n\n\tpublic onNotify() {\n\t\tif (!this.isFinal()) {\n\t\t\tthis.flags &= ~Flags.updated;\n\t\t\tdirtyPropagation.queue(this);\n\t\t}\n\t}\n}\n\nexport function computed<TValue>(getter: () => TValue, setter?: (value: TValue) => void) {\n\treturn new ComputedProperty(getter, setter);\n}","import {Property, computed} from '../property/library';\n\nexport type Script = string | number | ElementScript | ArrayScript | PropertyScript | DynamicListScript<any>;\nexport interface ArrayScript extends Array<Script> { }\nexport interface PropertyScript extends Property<Script> { }\n\nexport type CustomTag = (element: ElementScript) => Script;\nexport type Tag = string | CustomTag;\n\nexport function Fragment(element: ElementScript) {\n    return element.children;\n}\n\nexport class ElementScript {\n    public constructor(\n        public tag: Tag,\n        public attrs: { [attr: string]: any },\n        public children: Script[]\n    ) { }\n}\n\nexport type MapFunc<T> = (value: Property<T>, index: Property<number>, length: Property<number>) => Script;\nexport interface MapPropertyOptions<T> {\n    mapFunc: MapFunc<T>,\n    keyFunc?: (value: T) => (string | number)[],\n    unordered?: boolean\n};\n\nexport class DynamicListScript<T> {\n    public constructor(\n        public property: Property<T[]>,\n        public mapFunc: MapFunc<T>,\n        public keyFunc: (model: T) => any[],\n        public unordered: boolean\n    ) { }\n}\n\nexport function dynamicList<T>(\n    property: Property<T[]>,\n    mapFuncOrOptions: MapFunc<T> | MapPropertyOptions<T>) {\n    let options: MapPropertyOptions<T> = (typeof mapFuncOrOptions !== 'object') ?\n        { mapFunc: mapFuncOrOptions } : mapFuncOrOptions as any;\n    return new DynamicListScript(\n        property,\n        options.mapFunc,\n        options.keyFunc,\n        options.unordered\n    );\n}\n\nexport function dynamic<T>(property: Property<T>, mapFunc: MapFunc<T>) {\n    return new DynamicListScript(\n        computed(() => {\n            let value = property();\n            if (value != null) {\n                return [value];\n            } else {\n                return [];\n            }\n        }),\n        mapFunc,\n        (value) => [value],\n        true\n    );\n}\n\nexport const React = {\n    createElement(tag: Tag, attrs: { [attr: string]: any }, ...children: Script[]) {\n        return new ElementScript(tag, attrs, children);\n    }\n};\n","import {Context} from '../render';\n\nexport function renderText(context: Context, script: string) {\n\treturn document.createTextNode(script);\n}","import {CustomTag, ElementScript} from '../script';\nimport {Context, renderScript, bind, Binding} from '../render';\nimport {Property} from '../../property/library';\n\nconst fixUnitBlackUnit = {\n    'column-count': true,\n    'fill-opacity': true,\n    'flex': true,\n    'flex-grow': true,\n    'flex-shrink': true,\n    'font-weight': true,\n    'line-clamp': true,\n    'line-height': true,\n    'opacity': true,\n    'order': true,\n    'orphans': true,\n    'widows': true,\n    'zIndex': true,\n    'zoom': true\n};\n\nfunction setStyle(element: HTMLElement, prop: string, value: string | number) {\n\tif (typeof value === 'number' && !fixUnitBlackUnit[prop]) {\n\t\tvalue = value + 'px';\n\t}\n\telement.style.setProperty(prop, value + '');\n}\n\nfunction visitStyle(target: any, callback: (prop: string, value: any) => void, prefix: string) {\n\tObject.keys(target).forEach((prop) => {\n\t\tlet value = target[prop];\n\t\tif (value == null) {\n\t\t\treturn;\n\t\t}\n\t\tprop = prefix + prop;\n\t\tif (value.constructor === Object) {\n\t\t\tvisitStyle(value, callback, prop + '-');\n\t\t\treturn;\n\t\t}\n\t\tcallback(prop, value);\n\t});\n}\n\nfunction setStyles(context: Context, element: HTMLElement, styles: any) {\n\tvisitStyle(styles, (prop, propValue) => {\n\t\tif (propValue instanceof Property) {\n\t\t\tcontext.bindings.push(bind<any>(propValue, (propValue) => {\n                setStyle(element, prop, propValue);\n            }));\n\t\t} else {\n\t\t\tsetStyle(element, prop, propValue);\n\t\t}\n\t}, '');\n}\n\nclass ListenerBinding implements Binding {\n    public constructor(\n        private target: EventTarget,\n        private type: string,\n        private listener: EventListener\n    ) { }\n    public setup() {\n        this.target.addEventListener(this.type, this.listener);\n    }\n    public cleanup() {\n        this.target.removeEventListener(this.type, this.listener);\n    }\n}\n\nfunction setListener(context: Context, element: HTMLElement, type: string, value: Property<EventListener> | EventListener) {\n\tlet listener: EventListener;\n\tif (value instanceof Property) {\n\t\tlistener = (evt) => {\n\t\t\tlet handler = value.value();\n\t\t\tif (handler != null) {\n\t\t\t\treturn handler(evt);\n\t\t\t}\n\t\t};\n\t} else {\n\t\tlistener = value;\n\t}\n    context.bindings.push(new ListenerBinding(element, type, listener));\n}\n\nfunction setAttr(element: HTMLElement, attr: string, attrValue: any) {\n\tif (attr === 'style') {\n\t\telement.style.cssText = attrValue;\n\t\treturn;\n\t}\n\n\tif (attr === 'for') {\n\t\tattr = 'htmlFor';\n\t} else if (attr === 'class') {\n\t\tattr = 'className';\n\t}\n\n\tif (attr in element) {\n\t\telement[attr] = attrValue;\n\t\treturn;\n\t}\n\n\telement.setAttribute(attr, attrValue);\n}\n\nexport function renderElement(context: Context, script: ElementScript) {\n\tlet tag = script.tag;\n\tif (typeof tag !== 'string') {\n\t\treturn renderScript(context, tag(script));\n\t}\n\t\n\tlet element = document.createElement(tag as string);\n\tif (script.attrs !== null) {\n\t\tObject.keys(script.attrs).forEach((attr) => {\n\t\t\tlet attrValue = script.attrs[attr];\n\t\t\tif (attrValue == null) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (attr.startsWith('on')) {\n\t\t\t\tsetListener(context, element, attr.substring(2), attrValue);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (attr === 'style' && attrValue.constructor === Object) {\n\t\t\t\tsetStyles(context, element, attrValue);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (attrValue instanceof Property) {\n                context.bindings.push(bind<any>(attrValue, (attrValue) => {\n                    setAttr(element, attr, attrValue);\n                }));\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tsetAttr(element, attr, attrValue);\n\t\t});\n\t}\n\n\tscript.children.forEach((script) => {\n\t\telement.appendChild(renderScript(context, script));\n\t});\n\n\treturn element;\n}\n","import {Script} from '../script';\nimport {Context, renderScript} from '../render';\n\nexport function renderFragment(context: Context, script: Script[]) {\n\tlet fragment = document.createDocumentFragment();\n\tfor (let childScript of script) {\n\t\tfragment.appendChild(renderScript(context, childScript));\n\t}\n\treturn fragment;\n}\n","import {Property, observe} from '../../property/library';\nimport {Script} from '../script';\nimport {Context, render, bind} from '../render';\n\nexport function renderProperty(context: Context, script: Property<any>) {\n    let text = document.createTextNode('');\n    context.bindings.push(bind(script, (value) => {\n        text.data = value + '';\n    }));\n    return text;\n}\n","// copied from knockout.\nvar statusNotInOld = 'added',\n    statusNotInNew = 'deleted';\n\n// Simple calculation based on Levenshtein distance.\nexport function compareArrays(oldArray, newArray, options?) {\n    // For backward compatibility, if the third arg is actually a bool, interpret\n    // it as the old parameter 'dontLimitMoves'. Newer code should use { dontLimitMoves: true }.\n    options = (typeof options === 'boolean') ? {'dontLimitMoves': options} : (options || {});\n    oldArray = oldArray || [];\n    newArray = newArray || [];\n\n    if (oldArray.length <= newArray.length)\n        return compareSmallArrayToBigArray(oldArray, newArray, statusNotInOld, statusNotInNew, options);\n    else\n        return compareSmallArrayToBigArray(newArray, oldArray, statusNotInNew, statusNotInOld, options);\n}\n\n// Go through the items that have been added and deleted and try to find matches between them.\nvar findMovesInArrayComparison = function (left, right, limitFailedCompares) {\n    if (left.length && right.length) {\n        var failedCompares, l, r, leftItem, rightItem;\n        for (failedCompares = l = 0; (!limitFailedCompares || failedCompares < limitFailedCompares) && (leftItem = left[l]); ++l) {\n            for (r = 0; rightItem = right[r]; ++r) {\n                if (leftItem['value'] === rightItem['value']) {\n                    leftItem['moved'] = rightItem['index'];\n                    rightItem['moved'] = leftItem['index'];\n                    right.splice(r, 1);         // This item is marked as moved; so remove it from right list\n                    failedCompares = r = 0;     // Reset failed compares count because we're checking for consecutive failures\n                    break;\n                }\n            }\n            failedCompares += r;\n        }\n    }\n};\n\nfunction compareSmallArrayToBigArray(smlArray, bigArray, statusNotInSml, statusNotInBig, options) {\n    var myMin = Math.min,\n        myMax = Math.max,\n        editDistanceMatrix = [],\n        smlIndex, smlIndexMax = smlArray.length,\n        bigIndex, bigIndexMax = bigArray.length,\n        compareRange = (bigIndexMax - smlIndexMax) || 1,\n        maxDistance = smlIndexMax + bigIndexMax + 1,\n        thisRow, lastRow,\n        bigIndexMaxForRow, bigIndexMinForRow;\n\n    for (smlIndex = 0; smlIndex <= smlIndexMax; smlIndex++) {\n        lastRow = thisRow;\n        editDistanceMatrix.push(thisRow = []);\n        bigIndexMaxForRow = myMin(bigIndexMax, smlIndex + compareRange);\n        bigIndexMinForRow = myMax(0, smlIndex - 1);\n        for (bigIndex = bigIndexMinForRow; bigIndex <= bigIndexMaxForRow; bigIndex++) {\n            if (!bigIndex)\n                thisRow[bigIndex] = smlIndex + 1;\n            else if (!smlIndex)  // Top row - transform empty array into new array via additions\n                thisRow[bigIndex] = bigIndex + 1;\n            else if (smlArray[smlIndex - 1] === bigArray[bigIndex - 1])\n                thisRow[bigIndex] = lastRow[bigIndex - 1];                  // copy value (no edit)\n            else {\n                var northDistance = lastRow[bigIndex] || maxDistance;       // not in big (deletion)\n                var westDistance = thisRow[bigIndex - 1] || maxDistance;    // not in small (addition)\n                thisRow[bigIndex] = myMin(northDistance, westDistance) + 1;\n            }\n        }\n    }\n\n    var editScript = [], meMinusOne, notInSml = [], notInBig = [];\n    for (smlIndex = smlIndexMax, bigIndex = bigIndexMax; smlIndex || bigIndex;) {\n        meMinusOne = editDistanceMatrix[smlIndex][bigIndex] - 1;\n        if (bigIndex && meMinusOne === editDistanceMatrix[smlIndex][bigIndex - 1]) {\n            notInSml.push(editScript[editScript.length] = {     // added\n                'status': statusNotInSml,\n                'value': bigArray[--bigIndex],\n                'index': bigIndex\n            });\n        } else if (smlIndex && meMinusOne === editDistanceMatrix[smlIndex - 1][bigIndex]) {\n            notInBig.push(editScript[editScript.length] = {     // deleted\n                'status': statusNotInBig,\n                'value': smlArray[--smlIndex],\n                'index': smlIndex\n            });\n        } else {\n            --bigIndex;\n            --smlIndex;\n            if (!options['sparse']) {\n                editScript.push({\n                    'status': \"retained\",\n                    'value': bigArray[bigIndex]\n                });\n            }\n        }\n    }\n\n    // Set a limit on the number of consecutive non-matching comparisons; having it a multiple of\n    // smlIndexMax keeps the time complexity of this algorithm linear.\n    findMovesInArrayComparison(notInSml, notInBig, smlIndexMax * 10);\n\n    return editScript.reverse();\n}\n","export function insertAfter(newNode: Node, prevNode: Node) {\n    if (prevNode.nextSibling !== newNode) {\n        prevNode.parentNode.insertBefore(newNode, prevNode.nextSibling);\n    }\n}\n","export function iterateFromTil(node: Node, til: Node, callback: (node: Node) => void) {\n    let end = til.nextSibling;\n    while (node !== end) {\n        let next = node.nextSibling;\n        callback(node);\n        node = next;\n    }\n}","import {Script, DynamicListScript} from '../script';\nimport {stored} from '../../property/library';\nimport {Context, render, bind} from '../render';\nimport {compareArrays} from '../../utils/compare_arrays';\nimport {insertAfter} from '../../utils/insert_after';\nimport {iterateFromTil} from '../../utils/iterate_from_til';\n\nexport function renderDynamicList(context: Context, script: DynamicListScript<any>) {\n    let fragment = document.createDocumentFragment();\n    let startMarker = document.createComment('');\n    let endMarker = document.createComment('');\n    fragment.appendChild(startMarker);\n    fragment.appendChild(endMarker);\n\n    let lastArray = [];\n    let lastMappings = [];\n    context.bindings.push(bind(script.property, (array) => {\n        let editScript = compareArrays(lastArray, array);\n        let mappings = [];\n\n        let lastIndex = 0;\n        let trash = [];\n        let allocQueue = [];\n        let placeQueue = script.unordered ? [] : mappings;\n\n        for (let i = 0; i < editScript.length; i++) {\n            let record = editScript[i];\n            if (record.status === 'added') {\n                if (record.moved === undefined) {\n                    mappings.push(null);\n                    allocQueue.push(record);\n                } else {\n                    let lastMapping = lastMappings[record.moved];\n                    lastMapping._indexField.set(record.index);\n                    lastMapping._valueField.set(record.value);\n                    lastMapping._lengthField.set(array.length);\n                    mappings.push(lastMapping);\n                }\n            } else if (record.status === 'retained') {\n                let index = mappings.length;\n                let lastMapping = lastMappings[lastIndex];\n                lastMapping._indexField.set(index);\n                lastMapping._valueField.set(record.value);\n                lastMapping._lengthField.set(array.length);\n                mappings.push(lastMapping);\n                lastIndex++;\n            } else if (record.status === 'deleted') {\n                let lastMapping = lastMappings[record.index];\n                if (record.moved === undefined) {\n                    if (script.keyFunc !== undefined) {\n                        lastMapping._keys = script.keyFunc(record.value);\n                    }\n                    trash.push(lastMapping);\n                }\n                lastMapping._context.remove();\n                lastIndex++;\n            }\n        }\n\n        function recycle(keys: any[]) {\n            for (let i = 0; i < keys.length; i++) {\n                for (let j = 0; j < trash.length; j++) {\n                    if (keys[i] === trash[j]._keys[i]) {\n                        let mapping = trash[j];\n                        trash.splice(j, 1);\n                        return mapping;\n                    }\n                }\n            }\n            return null;\n        }\n\n        let setupQueue = [];\n        for (let i = 0; i < allocQueue.length; i++) {\n            let record = allocQueue[i];\n            let mapping = null;\n            if (script.keyFunc !== undefined) {\n                let keys = script.keyFunc(record.value);\n                mapping = recycle(keys);\n                if (mapping !== null) {\n                    mapping._indexField.set(record.index);\n                    mapping._valueField.set(record.value);\n                    mapping._lengthField.set(array.length);\n                }\n            }\n            if (mapping === null) {\n                let indexField = stored(record.index);\n                let valueField = stored(record.value);\n                let lengthField = stored(array.length);\n                let mappedScript = script.mapFunc(valueField, indexField, lengthField);\n                let context = render(mappedScript);\n                mapping = {\n                    _context: context,\n                    _indexField: indexField,\n                    _valueField: valueField,\n                    _lengthField: lengthField\n                };\n                if (script.unordered) {\n                    placeQueue.push(mapping);\n                }\n                setupQueue.push(context);\n            }\n            mappings[record.index] = mapping;\n        }\n\n        let prevNode: Node = startMarker;\n        for (let i = 0; i < placeQueue.length; i++) {\n            let mapping = placeQueue[i];\n            let context = mapping._context;\n            iterateFromTil(context.firstNode, context.lastNode, (node) => {\n                insertAfter(node, prevNode);\n                prevNode = node;\n            });\n        }\n\n        for (let i = 0; i < setupQueue.length; i++) {\n            setupQueue[i].setup();\n        }\n        \n        for (let i = 0; i < trash.length; i++) {\n            trash[i].destroy();\n        }\n\n        lastArray = array.slice(0);\n        lastMappings = mappings;\n    }));\n\n    return fragment;\n}","import {Property} from '../property/library';\nimport {Script, ElementScript, DynamicListScript} from './script';\nimport {renderText} from './render/text';\nimport {renderElement} from './render/element';\nimport {renderFragment} from './render/fragment';\nimport {renderProperty} from './render/property';\nimport {renderDynamicList} from './render/dynamic_list';\nimport {Callable} from '../utils/callable';\n\nexport const EMPTY_NODE = document.createDocumentFragment();\n\nexport class Context {\n\tpublic node: Node = EMPTY_NODE;\n    public firstNode: Node = null;\n    public lastNode: Node = null;\n\tpublic bindings: Binding[] = [];\n\n    public setNode(node: Node) {\n        this.node = node;\n        this.firstNode = node.nodeType === 11 ? node.firstChild : node;\n        this.lastNode = node.nodeType === 11 ? node.lastChild : node;\n    }\n\tpublic setup() {\n        this.bindings.forEach((binding) => binding.setup());\n\t}\n\tpublic cleanup() {\n        this.bindings.forEach((binding) => binding.cleanup());\n\t}\n    public remove() {\n        if (this.firstNode !== null && this.node.nodeType !== 11) {\n            let range = document.createRange();\n            range.setStartBefore(this.firstNode);\n            range.setEndAfter(this.lastNode);\n            let fragment = range.extractContents();\n            this.setNode(fragment);\n        }\n    }\n    public destroy() {\n        this.cleanup();\n        this.remove();\n    }\n}\n\nlet updateQueue = new Set<UpdaterBinding<any>>();\nlet updateCallbacks: (() => void)[] = [];\n\nfunction redraw() {\n    updateQueue.forEach((binding) => {\n        binding.update();\n    });\n    updateQueue.clear();\n    let callbacks = updateCallbacks;\n    updateCallbacks = [];\n    callbacks.forEach((callback) => callback());\n}\n\nfunction schedule(binding: UpdaterBinding<any>) {\n    if (updateQueue.size <= 0) {\n        window.requestAnimationFrame(redraw);\n    }\n    updateQueue.add(binding);\n}\n\nexport function waitForNextReflow(callback: () => void) {\n    updateCallbacks.push(callback);\n}\n\nexport interface Binding {\n    setup();\n    cleanup();\n}\n\nexport class UpdaterBinding<T> implements Binding {\n    private version: number;\n    private property: Property<T>;\n    private updater: (value: T) => void;\n    public constructor(property: Property<T>, updater: (value: T) => void) {\n        this.property = property;\n        this.updater = updater;\n    }\n    public onNotify() {\n        schedule(this);\n    }\n    public update() {\n        let value = this.property.value();\n        if (this.property.version !== this.version) {\n            this.version = this.property.version;\n            this.updater(value);\n        }\n    }\n    public setup() {\n        this.property.addObserver(this);\n        let value = this.property.value();\n        this.version = this.property.version;\n        this.updater(value);\n    }\n    public cleanup() {\n        this.property.removeObserver(this);\n    }\n}\n\nexport function bind<T>(property: Property<T>, updater: (value: T) => void) {\n    return new UpdaterBinding(property, updater);\n}\n\nexport function renderScript(context: Context, script: Script): Node {\n\tif (script == null) {\n\t\treturn EMPTY_NODE;\n\t}\n\n\tlet type = typeof script;\n\tif (type === 'number' || type === 'string') {\n\t\treturn renderText(context, script + '');\n\t}\n\n\tif (script instanceof ElementScript) {\n\t\treturn renderElement(context, script);\n\t}\n\n    if (script instanceof DynamicListScript) {\n        return renderDynamicList(context, script);\n    }\n\n\tif (script instanceof Property) {\n\t\treturn renderProperty(context, script);\n\t}\n\n\tif (Array.isArray(script)) {\n\t\treturn renderFragment(context, script);\n\t}\n\n\tthrow new Error('Unknown script');\n}\n\nexport function render(script: Script) {\n\tlet context = new Context();\n\tcontext.setNode(renderScript(context, script));\n\treturn context;\n}\n","import {stored, computed, Fragment, React, dynamicList, render} from '../../src/library';\n\nlet counter = stored(0);\nfunction increment() {\n    counter.set(counter() + 1);\n}\n\nlet ctx = render(\n\t<Fragment>\n        {counter}\n        <button onclick={increment}>increment</button>\n\t</Fragment>\n);\n\ndocument.body.appendChild(ctx.node);\nctx.setup();\n"],"names":["dirtyPropagation.mark","dependencyDetection.track","dirtyPropagation.queue","dirtyPropagation.commit","dependencyDetection.evaluate","updateQueue","schedule"],"mappings":"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"}